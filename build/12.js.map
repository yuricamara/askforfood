{"version":3,"sources":["../../src/pages/cart-step4/cart-step4.module.ts","../../src/pages/cart-step4/cart-step4.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACH;AAU7C;IAAA;IAAkC,CAAC;IAAtB,mBAAmB;QAR/B,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,kEAAa;aACd;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,kEAAa,CAAC;aACxC;SACF,CAAC;OACW,mBAAmB,CAAG;IAAD,0BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;ACZU;AACI;AACM;AAES;AAEtB;AAOvC;IAGE,uBACS,eAAgC,EAC/B,WAAuB,EACxB,OAAsB,EACrB,eAAgC;QAHjC,oBAAe,GAAf,eAAe,CAAiB;QAC/B,gBAAW,GAAX,WAAW,CAAY;QACxB,YAAO,GAAP,OAAO,CAAe;QACrB,oBAAe,GAAf,eAAe,CAAiB;IACvC,CAAC;IAEJ,sCAAc,GAAd;QACE,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEO,8BAAM,GAAd;QAAA,iBAUC;QATC,IAAI,CAAC,eAAe;aACjB,SAAS;aACT,IAAI,CAAC,6DAAK,EAAE,CAAC;aACb,SAAS,CAAC,cAAI;YACb,EAAE,EAAC,CAAC,IAAI,CAAC,EAAC;gBAAC,MAAM,CAAC;YAAC,CAAC;YAEpB,KAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;YACpB,KAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC,EAAE,eAAK,IAAI,cAAO,CAAC,KAAK,CAAC,KAAK,CAAC,EAApB,CAAoB,CAAC,CAAC;IACtC,CAAC;IAEO,kCAAU,GAAlB;QAAA,iBAeC;QAdC,IAAI,CAAC,WAAW;aACb,UAAU,EAAE;aACZ,IAAI,CAAC,6DAAK,EAAE,CAAC;aACb,SAAS,CAAC,kBAAQ;YACjB,EAAE,EAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAC;gBAAC,MAAM,CAAC;YAAC,CAAC;YAE/B,IAAI,WAAW,GAAG,EAAE,CAAC;YACrB,QAAQ,CAAC,OAAO,CAAC,iBAAO;gBACtB,WAAW,IAAO,OAAO,MAAG,CAAC,CAAC,gBAAgB;YAChD,CAAC,CAAC,CAAC;YAEH,KAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,CAAC;YACzC,KAAI,CAAC,qBAAqB,EAAE,CAAC;QAC/B,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,6CAAqB,GAA7B;QACE,IAAI,CAAC,WAAW;aACb,SAAS,EAAE;aACX,IAAI,CAAE,cAAM,cAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,EAA7C,CAA6C,EACxD,eAAK,IAAI,cAAO,CAAC,KAAK,CAAC,KAAK,CAAC,EAApB,CAAoB,CAC9B,CAAC;IACN,CAAC;IAEO,8CAAsB,GAA9B,UAA+B,WAAkB;QAC/C,IAAI,CAAC,eAAe;aACjB,sBAAsB,CAAC;YACtB,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,WAAW;SACZ,CAAC;aACD,IAAI,CAAE,cAAM,cAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC,EAA3D,CAA2D,EACtE,eAAK,IAAI,cAAO,CAAC,KAAK,CAAC,KAAK,CAAC,EAApB,CAAoB,CAC9B,CAAC;IACN,CAAC;IAED,oCAAY,GAAZ;QACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;IACnC,CAAC;IAhEU,aAAa;QAJzB,wEAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;WACG;SAC/B,CAAC;2EAKyC;YACnB,oEAAW;YACf,kEAAa;YACJ,UAAe;OAP/B,aAAa,CAiEzB;IAAD,CAAC;AAAA;SAjEY,aAAa,gB","file":"12.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { CartStep4Page } from './cart-step4';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    CartStep4Page,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(CartStep4Page),\r\n  ],\r\n})\r\nexport class CartStep4PageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart-step4/cart-step4.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController } from 'ionic-angular';\nimport { AngularFireAuth } from 'angularfire2/auth';\n\nimport { CartService,PurchaseService } from '../../services';\n\nimport { first } from 'rxjs/operators';\n\n@IonicPage({\n  segment: 'cart/step4'\n})\n@Component({\n  selector: 'page-cart-step4',\n  templateUrl: 'cart-step4.html',\n})\nexport class CartStep4Page {\n  uid: string;\n\n  constructor(\n    public angularFireAuth: AngularFireAuth,\n    private cartService:CartService,\n    public navCtrl: NavController,\n    private purchaseService: PurchaseService\n  ) {}\n\n  ionViewDidLoad(){\n    this.getUid();\n  }\n\n  private getUid(){\n    this.angularFireAuth\n      .authState\n      .pipe(first())\n      .subscribe(user => {\n        if(!user){ return; }\n\n        this.uid = user.uid;\n        this.getAllSkus();\n      }, error => console.error(error));\n  }\n\n  private getAllSkus() {\n    this.cartService\n      .getAllSkus()\n      .pipe(first())\n      .subscribe(products => {\n        if(!products.length){ return; }\n\n        let productsKey = '';\n        products.forEach(product => {\n          productsKey += `${product} `; // Manter espaço\n        });\n\n        this.addProductsToPurchases(productsKey);\n        this.emptyCartFromUserCart();\n      });\n  }\n\n  private emptyCartFromUserCart(){\n    this.cartService\n      .emptyCart()\n      .then( () => console.log('Produtos removidos do carrinho'),\n        error => console.error(error)\n      );\n  }\n\n  private addProductsToPurchases(productsKey:string){\n    this.purchaseService\n      .addProductsToPurchases({\n        uid: this.uid,\n        productsKey\n      })\n      .then( () => console.log('Produtos adicionados ao histórico de compras'),\n        error => console.error(error)\n      );\n  }\n\n  goToHomePage(){\n    this.navCtrl.setRoot('HomePage');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart-step4/cart-step4.ts"],"sourceRoot":""}